# Example payment module

## About

This repository provides an example to kick start your own payment module development. For more information, head on to the [Official Developer Documentation][documentation].

PrestaShop 1.7 introduced a new payment API. Below, you’ll find information about how it works and also, how to migrate your module from PrestaShop 1.6 (and earlier) to PrestaShop 1.7.

The main reason why the change was needed is on the customer side: there is now only one button to validate the order, not one by payment module anymore.

## Requirements

Your class needs to extend `PaymentModule`.

You need to declare the following namespace.
```
use PrestaShop\PrestaShop\Core\Payment\PaymentOption;
```

You need to register the two following methods: `hookPaymentOptions()` and `hookPaymentReturn()` and register these as hooks.

You must not have a submit button into your HTML code. It will automatically be generated by PrestaShop.

In the `hookPaymentOptions()` method, you have to return an array of `PaymentOption`.

### Insights

#### How to generate your PaymentOption

All PaymentOption properties have a getter and a setter and are accessible in the array sent to the front office template.

- $callToActionText: The text displayed as the payment method name.
- $additionalInformation: Additional information to display to the customer. This is free HTML, and may be used by modules such as bankwire to display to which account the bank transfer should be made.
- $logo: The URL to a picture to display in the payment option selection widget.
- $action: The URL to which the request to process the payment must be made.
- $inputs: An associative array of additional parameters to use when sending the request to $action.
- $form: The custom HTML to display like a form to enter the credit card information.
- $iframe: The custom HTML containing an iframe with the payment confirmation widget for modules like ATOS.
- $moduleName: The name of the module.
- $binary: A boolean to set if the module form was generated by binaries and contains a submit button. It’s necessary to adapt the behavior.

#### PaymentOption types

You can find a example module illustrating the four identified cases of payment modules on GitHub.

Four cases of payment module:

**Offline**

This is the most simple case where you could be (e.g.: Bankwire, Cheque)

Simple URL to call, then various information are displayed to the customer.

The minimal variables to set are $callToActionText and $action. You can check the getOfflinePaymentOption() method of paymentexample to have an example.

**External**

Simple URL to call, then the payment is directly processed on the Payment Service Provider’s website (e.g.: PayPal, Paybox).

The minimal variables to set are $callToActionText and $action. The form will be sent by POST and you can add hidden inputs, such as a token, by using setInput() method. You can check the getExternalPaymentOption() method of paymentexample to have an example.

**Embedded**

You write your credit card number and all the required data directly on the merchant’s website (e.g.: Stripe).

The minimal variables to set are $callToActionText and $form. You can check the getEmbeddedPaymentOption() method of paymentexample to have an example.

**Iframe**

The payment form is displayed on the merchant's website, but inside an iFrame.

The minimal variables to set are $callToActionText and $additionalInformation. You can check the getIframePaymentOption() method of paymentexample to have an example.

## Contributing

PrestaShop modules are open source extensions to the [PrestaShop e-commerce platform][prestashop]. Everyone is welcome and even encouraged to contribute with their own improvements!

Just make sure to follow our [contribution guidelines][contribution-guidelines].

## License

This module is released under the [Academic Free License 3.0][AFL-3.0] 

[documentation]: https://devdocs.prestashop.com/1.7/modules/
[prestashop]: https://www.prestashop.com/
[contribution-guidelines]: https://devdocs.prestashop.com/1.7/contribute/contribution-guidelines/project-modules/
[AFL-3.0]: https://opensource.org/licenses/AFL-3.0
